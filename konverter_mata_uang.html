<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Konverter Mata Uang</title>
  <!-- Load Tailwind CSS from CDN -->
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800&display=swap" rel="stylesheet">
  <style>
    body {
      font-family: 'Inter', sans-serif;
    }
    /* Custom styles for select arrow appearance */
    select {
      -webkit-appearance: none;
      -moz-appearance: none;
      appearance: none;
      background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 20 20' fill='currentColor'%3E%3Cpath fill-rule='evenodd' d='M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z' clip-rule='evenodd' /%3E%3C/svg%3E");
      background-repeat: no-repeat;
      background-position: right 0.75rem center;
      background-size: 1.5em 1.5em;
    }
  </style>
</head>
<body class="min-h-screen bg-gradient-to-br from-indigo-800 via-purple-800 to-pink-800 flex items-center justify-center p-4">
  <div class="bg-white bg-opacity-95 p-8 rounded-3xl shadow-xl border border-white border-opacity-30 w-full max-w-lg space-y-7 transform hover:scale-105 transition-transform duration-500 ease-in-out backdrop-filter backdrop-blur-lg">
    <h1 class="text-5xl font-extrabold text-center text-gray-900 mb-6 tracking-tight">Konverter Mata Uang</h1>

    <!-- Input section -->
    <div class="space-y-5">
      <div>
        <label htmlFor="amount" class="block text-base font-medium text-gray-700 mb-2">
          Jumlah:
        </label>
        <input
          type="number"
          id="amount"
          value="1"
          class="mt-1 block w-full px-5 py-3 border border-gray-300 rounded-xl shadow-sm focus:outline-none focus:ring-4 focus:ring-blue-400 focus:border-blue-400 text-xl placeholder-gray-400 transition-all duration-300 ease-in-out"
          min="0"
          step="0.01"
          placeholder="Masukkan jumlah"
        />
      </div>

      <div class="grid grid-cols-1 md:grid-cols-2 gap-5">
        <div>
          <label htmlFor="fromCurrency" class="block text-base font-medium text-gray-700 mb-2">
            Dari Mata Uang:
          </label>
          <select
            id="fromCurrency"
            class="mt-1 block w-full px-5 py-3 border border-gray-300 rounded-xl shadow-sm focus:outline-none focus:ring-4 focus:ring-blue-400 focus:border-blue-400 text-xl cursor-pointer bg-white transition-all duration-300 ease-in-out"
          >
            <!-- Options will be dynamically loaded by JavaScript -->
          </select>
        </div>

        <div>
          <label htmlFor="toCurrency" class="block text-base font-medium text-gray-700 mb-2">
            Ke Mata Uang:
          </label>
          <select
            id="toCurrency"
            class="mt-1 block w-full px-5 py-3 border border-gray-300 rounded-xl shadow-sm focus:outline-none focus:ring-4 focus:ring-blue-400 focus:border-blue-400 text-xl cursor-pointer bg-white transition-all duration-300 ease-in-out"
          >
            <!-- Options will be dynamically loaded by JavaScript -->
          </select>
        </div>
      </div>
    </div>

    <!-- Display results or loading/error messages -->
    <div id="results" class="mt-8 text-center min-h-[120px] flex items-center justify-center">
      <!-- Content will be dynamically loaded by JavaScript -->
    </div>
  </div>

  <script>
    // IMPORTANT: Replace 'YOUR_API_KEY_HERE' with your actual API key from exchangerate-api.com
    const API_KEY = '98095bad2e3dd6ff0831e9b6';

    const currencies = [
      'USD', 'EUR', 'GBP', 'JPY', 'CAD', 'AUD', 'SGD', 'CNY', 'INR', 'IDR', 'MYR', 'THB', 'VND', 'PHP', 'KRW', 'NZD', 'CHF', 'SEK', 'NOK', 'DKK', 'RUB', 'BRL', 'ZAR', 'HKD', 'MXN', 'SAR', 'AED', 'TRY', 'EGP', 'PLN', 'ILS', 'KWD', 'QAR', 'OMR', 'BHD'
    ];

    // DOM elements
    const amountInput = document.getElementById('amount');
    const fromCurrencySelect = document.getElementById('fromCurrency');
    const toCurrencySelect = document.getElementById('toCurrency');
    const resultsDiv = document.getElementById('results');

    // Initial state
    let amount = parseFloat(amountInput.value);
    let fromCurrency = 'USD';
    let toCurrency = 'IDR';
    let exchangeRate = null;
    let convertedAmount = null;
    let loading = false;
    let error = null;

    // Function to populate currency dropdowns
    function populateCurrencies() {
      currencies.forEach(currency => {
        const optionFrom = document.createElement('option');
        optionFrom.value = currency;
        optionFrom.textContent = currency;
        fromCurrencySelect.appendChild(optionFrom);

        const optionTo = document.createElement('option');
        optionTo.value = currency;
        optionTo.textContent = currency;
        toCurrencySelect.appendChild(optionTo);
      });

      // Set initial selected values
      fromCurrencySelect.value = fromCurrency;
      toCurrencySelect.value = toCurrency;
    }

    // Function to render UI based on current state
    function render() {
      resultsDiv.innerHTML = ''; // Clear previous content

      if (loading) {
        resultsDiv.innerHTML = `
          <div class="flex flex-col items-center justify-center space-y-3 text-indigo-700">
            <svg class="animate-spin h-8 w-8 text-indigo-600" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
              <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" strokeWidth="4"></circle>
              <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
            </svg>
            <span class="text-lg font-semibold">Mengambil nilai tukar...</span>
          </div>
        `;
      } else if (error) {
        resultsDiv.innerHTML = `
          <div class="p-5 bg-red-100 text-red-700 rounded-xl shadow-md border-l-4 border-red-500 flex flex-col items-start text-left">
            <p class="font-bold text-lg mb-2">Kesalahan:</p>
            <p class="text-base">${error}</p>
            <p class="mt-3 text-sm italic text-red-600">Harap pastikan Anda telah mengganti '<span class="font-bold">YOUR_API_KEY_HERE</span>' di kode dengan kunci API yang valid dari <a href="https://www.exchangerate-api.com/" target="_blank" rel="noopener noreferrer" class="text-red-800 underline hover:text-red-900">ExchangeRate-API</a>.</p>
          </div>
        `;
      } else if (convertedAmount !== null) {
        resultsDiv.innerHTML = `
          <div class="p-5 bg-gradient-to-r from-blue-500 to-indigo-600 text-white rounded-xl shadow-lg border-l-4 border-white transform hover:scale-102 transition-transform duration-300 ease-in-out">
            <p class="text-xl font-medium opacity-90">
              ${amount} ${fromCurrency} =
            </p>
            <p class="text-4xl font-extrabold mt-2 tracking-wide">
              ${convertedAmount} ${toCurrency}
            </p>
            ${exchangeRate && exchangeRate !== 1 ? `<p class="text-sm opacity-80 mt-2">(1 ${fromCurrency} = ${exchangeRate.toFixed(4)} ${toCurrency})</p>` : ''}
          </div>
        `;
      }
    }

    // Function to fetch exchange rates
    async function fetchExchangeRate() {
      loading = true;
      error = null;
      convertedAmount = null;
      render(); // Update UI to show loading state

      if (API_KEY === 'YOUR_API_KEY_HERE') {
        error = 'Kunci API belum diatur. Harap ganti \'YOUR_API_KEY_HERE\' di kode dengan kunci API yang valid dari ExchangeRate-API.';
        loading = false;
        render();
        return;
      }

      if (fromCurrency === toCurrency) {
        exchangeRate = 1;
        convertedAmount = amount;
        loading = false;
        render();
        return;
      }

      try {
        const response = await fetch(`https://v6.exchangerate-api.com/v6/${API_KEY}/latest/${fromCurrency}`);
        const data = await response.json();

        if (data.result === 'success') {
          const rate = data.conversion_rates[toCurrency];
          if (rate) {
            exchangeRate = rate;
            convertedAmount = (amount * rate).toFixed(2);
          } else {
            error = `Tidak dapat menemukan nilai tukar untuk ${toCurrency}`;
          }
        } else {
          error = `Gagal mengambil nilai tukar: ${data['error-type'] || 'Kesalahan tidak diketahui'}. Pastikan Kunci API Anda benar.`;
        }
      } catch (err) {
        console.error("Error fetching exchange rate:", err);
        error = 'Terjadi kesalahan saat mengambil nilai tukar. Periksa koneksi internet Anda atau Kunci API.';
      } finally {
        loading = false;
        render(); // Update UI with results or error
      }
    }

    // Event Listeners
    amountInput.addEventListener('input', (e) => {
      amount = parseFloat(e.target.value);
      if (isNaN(amount)) amount = 0;
      fetchExchangeRate();
    });

    fromCurrencySelect.addEventListener('change', (e) => {
      fromCurrency = e.target.value;
      fetchExchangeRate();
    });

    toCurrencySelect.addEventListener('change', (e) => {
      toCurrency = e.target.value;
      fetchExchangeRate();
    });

    // Initial setup and fetch on page load
    window.onload = function() {
      populateCurrencies();
      fetchExchangeRate();
    };
  </script>
</body>
</html>