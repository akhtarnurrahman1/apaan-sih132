<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Game Fisika - Bola Memantul</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 20px;
        }

        .game-container {
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            padding: 30px;
            max-width: 900px;
            width: 100%;
        }

        @media (max-width: 480px) {
            .game-container {
                padding: 15px;
                margin: 10px;
                border-radius: 15px;
            }
        }

        h1 {
            text-align: center;
            color: #333;
            margin-bottom: 20px;
            font-size: 2.5rem;
            background: linear-gradient(45deg, #667eea, #764ba2);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        @media (max-width: 480px) {
            h1 {
                font-size: 1.8rem;
                margin-bottom: 15px;
            }
        }

        .controls {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        button {
            background: linear-gradient(45deg, #667eea, #764ba2);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 16px;
            font-weight: 600;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);
            touch-action: manipulation;
        }

        @media (max-width: 480px) {
            button {
                padding: 10px 16px;
                font-size: 14px;
                min-width: 80px;
            }
        }

        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(102, 126, 234, 0.4);
        }

        button:active {
            transform: translateY(0);
        }

        .canvas-container {
            border: 3px solid #667eea;
            border-radius: 15px;
            overflow: hidden;
            margin: 20px auto;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
        }

        canvas {
            display: block;
            background: linear-gradient(180deg, #87CEEB 0%, #98FB98 100%);
            max-width: 100%;
            height: auto;
        }

        .info {
            display: flex;
            justify-content: space-between;
            margin-top: 20px;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 10px;
            flex-wrap: wrap;
            gap: 10px;
        }

        .info-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            min-width: 120px;
        }

        @media (max-width: 480px) {
            .info-item {
                min-width: 80px;
                flex: 1;
            }
        }

        .info-label {
            font-size: 14px;
            color: #666;
            margin-bottom: 5px;
        }

        .info-value {
            font-size: 18px;
            font-weight: bold;
            color: #333;
        }

        @media (max-width: 480px) {
            .info-label {
                font-size: 12px;
            }
            
            .info-value {
                font-size: 16px;
            }
        }

        .instructions {
            background: #e3f2fd;
            padding: 15px;
            border-radius: 10px;
            margin-top: 15px;
            border-left: 4px solid #667eea;
        }

        @media (max-width: 480px) {
            .instructions {
                padding: 12px;
                margin-top: 12px;
            }
        }

        .instructions h3 {
            color: #333;
            margin-bottom: 10px;
        }

        .instructions p {
            color: #666;
            line-height: 1.5;
        }

        @media (max-width: 768px) {
            .game-container {
                padding: 20px;
            }
            
            h1 {
                font-size: 2rem;
            }
            
            canvas {
                width: 100%;
                height: auto;
            }
        }
    </style>
</head>
<body>
    <div class="game-container">
        <h1>üèÄ Game Fisika Bola</h1>
        
        <div class="controls">
            <button onclick="addBall()">Tambah Bola</button>
            <button onclick="clearBalls()">Hapus Semua</button>
            <button onclick="toggleGravity()">Toggle Gravitasi</button>
            <button onclick="increaseBounce()">+ Pantulan</button>
            <button onclick="decreaseBounce()">- Pantulan</button>
        </div>

        <div class="canvas-container">
            <canvas id="gameCanvas" width="800" height="500"></canvas>
        </div>

        <div class="info">
            <div class="info-item">
                <div class="info-label">Jumlah Bola</div>
                <div class="info-value" id="ballCount">0</div>
            </div>
            <div class="info-item">
                <div class="info-label">Gravitasi</div>
                <div class="info-value" id="gravityStatus">ON</div>
            </div>
            <div class="info-item">
                <div class="info-label">Pantulan</div>
                <div class="info-value" id="bounceValue">0.8</div>
            </div>
            <div class="info-item">
                <div class="info-label">FPS</div>
                <div class="info-value" id="fpsCounter">60</div>
            </div>
        </div>

        <div class="instructions">
            <h3>üìã Cara Bermain:</h3>
            <p>‚Ä¢ Klik "Tambah Bola" untuk menambah bola baru<br>
            ‚Ä¢ Klik di canvas untuk menambah bola di posisi tersebut<br>
            ‚Ä¢ Toggle gravitasi untuk melihat efek tanpa gravitasi<br>
            ‚Ä¢ Atur tingkat pantulan bola dengan tombol + dan -</p>
        </div>
    </div>

    <script>
        const canvas = document.getElementById('gameCanvas');
        const ctx = canvas.getContext('2d');
        
        // Fungsi untuk menyesuaikan ukuran canvas
        function resizeCanvas() {
            const container = canvas.parentElement;
            const containerWidth = container.clientWidth - 6; // minus border
            
            if (window.innerWidth <= 480) {
                canvas.width = Math.min(containerWidth, 350);
                canvas.height = Math.min(canvas.width * 0.7, 300);
            } else if (window.innerWidth <= 768) {
                canvas.width = Math.min(containerWidth, 600);
                canvas.height = Math.min(canvas.width * 0.625, 400);
            } else {
                canvas.width = 800;
                canvas.height = 500;
            }
        }
        
        // Panggil saat load dan resize
        resizeCanvas();
        window.addEventListener('resize', resizeCanvas);
        
        let balls = [];
        let gravity = 0.5;
        let gravityEnabled = true;
        let bounce = 0.8;
        let lastTime = 0;
        let fps = 0;
        let frameCount = 0;
        let lastFpsUpdate = 0;

        class Ball {
            constructor(x, y) {
                this.x = x || Math.random() * (canvas.width - 40) + 20;
                this.y = y || Math.random() * 100 + 20;
                this.vx = (Math.random() - 0.5) * 10;
                this.vy = Math.random() * 5;
                this.radius = Math.random() * 20 + 10;
                this.color = this.getRandomColor();
                this.trail = [];
            }

            getRandomColor() {
                const colors = ['#FF6B6B', '#4ECDC4', '#45B7D1', '#96CEB4', '#FFEAA7', '#DDA0DD', '#98D8C8'];
                return colors[Math.floor(Math.random() * colors.length)];
            }

            update() {
                // Simpan posisi untuk trail
                this.trail.push({x: this.x, y: this.y});
                if (this.trail.length > 10) {
                    this.trail.shift();
                }

                // Terapkan gravitasi
                if (gravityEnabled) {
                    this.vy += gravity;
                }

                // Update posisi
                this.x += this.vx;
                this.y += this.vy;

                // Pantulan dengan dinding kiri dan kanan
                if (this.x + this.radius > canvas.width || this.x - this.radius < 0) {
                    this.vx *= -bounce;
                    this.x = this.x + this.radius > canvas.width ? 
                        canvas.width - this.radius : this.radius;
                }

                // Pantulan dengan lantai dan langit-langit
                if (this.y + this.radius > canvas.height || this.y - this.radius < 0) {
                    this.vy *= -bounce;
                    this.y = this.y + this.radius > canvas.height ? 
                        canvas.height - this.radius : this.radius;
                }

                // Reduksi kecepatan untuk simulasi gesekan udara
                this.vx *= 0.999;
                this.vy *= 0.999;
            }

            draw() {
                // Gambar trail
                ctx.globalAlpha = 0.3;
                for (let i = 0; i < this.trail.length; i++) {
                    const alpha = i / this.trail.length;
                    ctx.globalAlpha = alpha * 0.3;
                    ctx.fillStyle = this.color;
                    ctx.beginPath();
                    ctx.arc(this.trail[i].x, this.trail[i].y, this.radius * alpha, 0, Math.PI * 2);
                    ctx.fill();
                }

                // Gambar bola utama
                ctx.globalAlpha = 1;
                
                // Shadow
                ctx.fillStyle = 'rgba(0,0,0,0.2)';
                ctx.beginPath();
                ctx.arc(this.x + 3, this.y + 3, this.radius, 0, Math.PI * 2);
                ctx.fill();

                // Bola utama
                const gradient = ctx.createRadialGradient(
                    this.x - this.radius/3, this.y - this.radius/3, 0,
                    this.x, this.y, this.radius
                );
                gradient.addColorStop(0, this.color);
                gradient.addColorStop(1, this.darkenColor(this.color));
                
                ctx.fillStyle = gradient;
                ctx.beginPath();
                ctx.arc(this.x, this.y, this.radius, 0, Math.PI * 2);
                ctx.fill();

                // Highlight
                ctx.fillStyle = 'rgba(255,255,255,0.4)';
                ctx.beginPath();
                ctx.arc(this.x - this.radius/3, this.y - this.radius/3, this.radius/3, 0, Math.PI * 2);
                ctx.fill();
            }

            darkenColor(color) {
                const hex = color.replace('#', '');
                const r = Math.max(0, parseInt(hex.substr(0,2), 16) - 40);
                const g = Math.max(0, parseInt(hex.substr(2,2), 16) - 40);
                const b = Math.max(0, parseInt(hex.substr(4,2), 16) - 40);
                return `rgb(${r},${g},${b})`;
            }
        }

        function addBall(x, y) {
            balls.push(new Ball(x, y));
            updateInfo();
        }

        function clearBalls() {
            balls = [];
            updateInfo();
        }

        function toggleGravity() {
            gravityEnabled = !gravityEnabled;
            updateInfo();
        }

        function increaseBounce() {
            bounce = Math.min(1, bounce + 0.1);
            updateInfo();
        }

        function decreaseBounce() {
            bounce = Math.max(0.1, bounce - 0.1);
            updateInfo();
        }

        function updateInfo() {
            document.getElementById('ballCount').textContent = balls.length;
            document.getElementById('gravityStatus').textContent = gravityEnabled ? 'ON' : 'OFF';
            document.getElementById('bounceValue').textContent = bounce.toFixed(1);
        }

        function animate(currentTime) {
            // Hitung FPS
            frameCount++;
            if (currentTime - lastFpsUpdate > 1000) {
                fps = Math.round(frameCount * 1000 / (currentTime - lastFpsUpdate));
                document.getElementById('fpsCounter').textContent = fps;
                frameCount = 0;
                lastFpsUpdate = currentTime;
            }

            // Clear canvas
            ctx.clearRect(0, 0, canvas.width, canvas.height);

            // Update dan gambar semua bola
            balls.forEach(ball => {
                ball.update();
                ball.draw();
            });

            // Deteksi tabrakan antar bola
            for (let i = 0; i < balls.length; i++) {
                for (let j = i + 1; j < balls.length; j++) {
                    const ball1 = balls[i];
                    const ball2 = balls[j];
                    const dx = ball2.x - ball1.x;
                    const dy = ball2.y - ball1.y;
                    const distance = Math.sqrt(dx * dx + dy * dy);

                    if (distance < ball1.radius + ball2.radius) {
                        // Collision response
                        const angle = Math.atan2(dy, dx);
                        const sin = Math.sin(angle);
                        const cos = Math.cos(angle);

                        // Rotate velocities
                        const vx1 = ball1.vx * cos + ball1.vy * sin;
                        const vy1 = ball1.vy * cos - ball1.vx * sin;
                        const vx2 = ball2.vx * cos + ball2.vy * sin;
                        const vy2 = ball2.vy * cos - ball2.vx * sin;

                        // Swap velocities
                        const temp = vx1;
                        ball1.vx = (vx2 * cos - vy1 * sin) * bounce;
                        ball1.vy = (vy1 * cos + vx2 * sin) * bounce;
                        ball2.vx = (temp * cos - vy2 * sin) * bounce;
                        ball2.vy = (vy2 * cos + temp * sin) * bounce;

                        // Separate balls
                        const overlap = ball1.radius + ball2.radius - distance;
                        ball1.x -= overlap * 0.5 * cos;
                        ball1.y -= overlap * 0.5 * sin;
                        ball2.x += overlap * 0.5 * cos;
                        ball2.y += overlap * 0.5 * sin;
                    }
                }
            }

            requestAnimationFrame(animate);
        }

        // Event listener untuk klik dan touch canvas
        function handleCanvasInteraction(e) {
            e.preventDefault();
            const rect = canvas.getBoundingClientRect();
            const scaleX = canvas.width / rect.width;
            const scaleY = canvas.height / rect.height;
            
            let clientX, clientY;
            if (e.type === 'touchstart') {
                clientX = e.touches[0].clientX;
                clientY = e.touches[0].clientY;
            } else {
                clientX = e.clientX;
                clientY = e.clientY;
            }
            
            const x = (clientX - rect.left) * scaleX;
            const y = (clientY - rect.top) * scaleY;
            addBall(x, y);
        }
        
        canvas.addEventListener('click', handleCanvasInteraction);
        canvas.addEventListener('touchstart', handleCanvasInteraction);

        // Mulai dengan beberapa bola
        for (let i = 0; i < 3; i++) {
            addBall();
        }

        updateInfo();
        animate(0);
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'97819a7f36ff5607',t:'MTc1NjY5NjUzMC4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
