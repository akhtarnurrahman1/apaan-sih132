<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Aplikasi Jadwal Sholat</title>
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f0f4f8; /* Light blue-gray background */
        }
        .container {
            max-width: 90%;
            margin: 0 auto;
            padding: 1.5rem;
        }
        @media (min-width: 640px) {
            .container {
                max-width: 600px; /* Max width for larger screens */
            }
        }
        .card {
            background-color: #ffffff;
            border-radius: 0.75rem; /* Rounded corners */
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            padding: 1.5rem;
            margin-bottom: 1.5rem;
        }
        .btn-primary {
            background-color: #4f46e5; /* Indigo */
            color: #ffffff;
            padding: 0.75rem 1.5rem;
            border-radius: 0.5rem;
            font-weight: 600;
            transition: background-color 0.2s;
        }
        .btn-primary:hover {
            background-color: #4338ca; /* Darker indigo */
        }
        .input-field {
            padding: 0.625rem 1rem;
            border: 1px solid #d1d5db; /* Light gray border */
            border-radius: 0.5rem;
            width: 100%;
            font-size: 1rem;
        }
        .select-field {
            padding: 0.625rem 1rem;
            border: 1px solid #d1d5db;
            border-radius: 0.5rem;
            width: 100%;
            font-size: 1rem;
            appearance: none; /* Remove default arrow */
            background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 20 20' fill='none'%3e%3cpath d='M7 7l3-3 3 3m0 6l-3 3-3-3' stroke='%239CA3AF' stroke-width='1.5' stroke-linecap='round' stroke-linejoin='round'/%3e%3c/svg%3e"); /* Custom arrow */
            background-repeat: no-repeat;
            background-position: right 0.75rem center;
            background-size: 0.8em 0.8em;
        }
    </style>
</head>
<body class="bg-gray-100 flex items-center justify-center min-h-screen">
    <div class="container bg-white p-6 rounded-lg shadow-xl border-t-4 border-indigo-500">
        <h1 class="text-3xl font-bold text-center text-gray-800 mb-6">Jadwal Sholat Harian</h1>

        <div class="mb-6 space-y-4">
            <div>
                <label for="city" class="block text-sm font-medium text-gray-700 mb-1">Kota:</label>
                <input type="text" id="city" value="Jakarta" class="input-field focus:ring-indigo-500 focus:border-indigo-500" placeholder="Masukkan nama kota">
            </div>
            <div>
                <label for="country" class="block text-sm font-medium text-gray-700 mb-1">Negara:</label>
                <input type="text" id="country" value="Indonesia" class="input-field focus:ring-indigo-500 focus:border-indigo-500" placeholder="Masukkan nama negara">
            </div>
            <div>
                <label for="date" class="block text-sm font-medium text-gray-700 mb-1">Tanggal:</label>
                <input type="date" id="date" class="input-field focus:ring-indigo-500 focus:border-indigo-500">
            </div>
            <div>
                <label for="method" class="block text-sm font-medium text-gray-700 mb-1">Metode Perhitungan:</label>
                <select id="method" class="select-field focus:ring-indigo-500 focus:border-indigo-500">
                    <option value="2">Muslim World League</option>
                    <option value="1">University of Islamic Sciences, Karachi</option>
                    <option value="3">Islamic Society of North America (ISNA)</option>
                    <option value="4">Umm Al-Qura University, Makkah</option>
                    <option value="5">Egyptian General Authority of Survey</option>
                    <option value="7">Institute of Geophysics, University of Tehran</option>
                    <option value="8">Gulf Region</option>
                    <option value="9">Kuwait</option>
                    <option value="10">Qatar</option>
                    <option value="11">Majlis Ugama Islam Singapura (MUIS)</option>
                    <option value="12">Union of Islamic Organisations of France</option>
                    <option value="13">Diyanet İşleri Başkanlığı, Turkey</option>
                    <option value="14">Spiritual Administration of Muslims of Russia</option>
                    <option value="15">Dubai (Custom)</option>
                    <option value="16">Moonsighting Committee Worldwide (MCW)</option>
                    <option value="17">North America</option>
                    <option value="18">Tunisia</option>
                    <option value="19">Morocco</option>
                    <option value="20">Algeria</option>
                    <option value="21">Jafari</option>
                    <option value="22">Saudi Arabia</option>
                    <option value="23">France</option>
                </select>
            </div>
            <button id="getPrayerTimes" class="btn-primary w-full rounded-md shadow-md hover:shadow-lg transition duration-300 ease-in-out transform hover:-translate-y-1">
                Tampilkan Jadwal Sholat
            </button>
        </div>

        <div id="loading" class="text-center text-indigo-600 font-medium hidden">
            <svg class="animate-spin h-5 w-5 mr-3 inline-block text-indigo-500" viewBox="0 0 24 24">
                <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
            </svg>
            Memuat jadwal sholat...
        </div>

        <div id="prayerTimesResult" class="card hidden">
            <h2 class="text-xl font-semibold text-gray-800 mb-4">Waktu Sholat untuk <span id="displayCity"></span>, <span id="displayCountry"></span> pada <span id="displayDate"></span></h2>
            <div id="timesList" class="space-y-2">
                <!-- Prayer times will be injected here -->
            </div>
            <div id="error-message" class="text-red-600 font-medium mt-4 hidden"></div>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const cityInput = document.getElementById('city');
            const countryInput = document.getElementById('country');
            const dateInput = document.getElementById('date');
            const methodSelect = document.getElementById('method');
            const getPrayerTimesBtn = document.getElementById('getPrayerTimes');
            const loadingIndicator = document.getElementById('loading');
            const prayerTimesResult = document.getElementById('prayerTimesResult');
            const displayCity = document.getElementById('displayCity');
            const displayCountry = document.getElementById('displayCountry');
            const displayDate = document.getElementById('displayDate');
            const timesList = document.getElementById('timesList');
            const errorMessage = document.getElementById('error-message');

            const today = new Date();
            const yyyy = today.getFullYear();
            const mm = String(today.getMonth() + 1).padStart(2, '0');
            const dd = String(today.getDate()).padStart(2, '0');
            dateInput.value = `${yyyy}-${mm}-${dd}`;

            async function getPrayerTimes(city, country, date, method) {
                const apiUrl = `https://api.aladhan.com/v1/timingsByCity/${date}?city=${city}&country=${country}&method=${method}`;
                try {
                    const response = await fetch(apiUrl);
                    if (!response.ok) throw new Error("Gagal mengambil data.");
                    const data = await response.json();
                    return data.data;
                } catch (error) {
                    console.error("Error fetching prayer times:", error);
                    throw error;
                }
            }

            const formatTime = (timeString) => {
                let [hours, minutes] = timeString.split(':');
                hours = parseInt(hours);
                const ampm = hours >= 12 ? 'PM' : 'AM';
                hours = hours % 12;
                hours = hours ? hours : 12;
                return `${String(hours).padStart(2, '0')}:${minutes} ${ampm}`;
            };

            const displayPrayerTimes = (timings, city, country, dateDisplay) => {
                displayCity.textContent = city;
                displayCountry.textContent = country;
                displayDate.textContent = dateDisplay;
                timesList.innerHTML = '';

                const prayerNames = {
                    Fajr: 'Subuh',
                    Sunrise: 'Terbit Matahari',
                    Dhuhr: 'Dzuhur',
                    Asr: 'Ashar',
                    Sunset: 'Terbenam Matahari',
                    Maghrib: 'Maghrib',
                    Isha: 'Isya',
                    Imsak: 'Imsak',
                    Midnight: 'Tengah Malam'
                };

                for (const prayer in prayerNames) {
                    if (timings[prayer]) {
                        const timeItem = document.createElement('div');
                        timeItem.className = 'flex justify-between items-center py-2 px-3 bg-indigo-50 rounded-md';
                        timeItem.innerHTML = `
                            <span class="text-gray-700 font-medium">${prayerNames[prayer]}:</span>
                            <span class="text-indigo-700 font-semibold">${formatTime(timings[prayer])}</span>
                        `;
                        timesList.appendChild(timeItem);
                    }
                }
                prayerTimesResult.classList.remove('hidden');
            };

            getPrayerTimesBtn.addEventListener('click', async () => {
                const city = cityInput.value.trim();
                const country = countryInput.value.trim();
                const selectedDate = dateInput.value;
                const method = methodSelect.value;

                if (!city || !country || !selectedDate) {
                    alert("Harap masukkan Kota, Negara, dan Tanggal.");
                    return;
                }

                loadingIndicator.classList.remove('hidden');
                prayerTimesResult.classList.add('hidden');
                timesList.innerHTML = '';

                try {
                    const [year, month, day] = selectedDate.split('-');
                    const apiDate = `${day}-${month}-${year}`;
                    const data = await getPrayerTimes(city, country, apiDate, method);

                    if (data && data.timings) {
                        const options = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' };
                        const dateObj = new Date(selectedDate);
                        const dateDisplay = dateObj.toLocaleDateString('id-ID', options);
                        displayPrayerTimes(data.timings, city, country, dateDisplay);
                    } else {
                        alert("Data tidak ditemukan untuk lokasi/tanggal tersebut.");
                    }
                } catch (error) {
                    alert("Terjadi kesalahan saat mengambil data.");
                } finally {
                    loadingIndicator.classList.add('hidden');
                }
            });

            getPrayerTimesBtn.click();
        });
    </script>
</body>
</html>
